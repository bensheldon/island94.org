<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Island94.org : A lost and found</title>

  <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="uO7ZInlsfWk1NJbhkIlnDm-T4atZVX-jUzpxRuJH-ZXtD4-XCVdk8FbGkl1PRXMYHS7dOSe9Zm9HHfnsK7kt9w" />
  

  <link rel="alternate" type="application/rss+xml" title="Island94.org" href="https://island94.org/feed.xml">

  <link rel="stylesheet" href="/assets/application-39a1f2f7963cb72fa41194b70f3ff8033d1cbab7fae2f8cb78a801ed41144a6a.css" data-turbo-track="reload" />
  <script type="importmap" data-turbo-track="reload">{
  "imports": {
    "application": "/assets/application-962c5e7cf27f994bdd1d258cdf9ea6b030432b2f7bd4f3ddca08ef99383fa2f8.js",
    "popper": "/assets/popper-003a40d80fd205e1fa00da117d5bdc19720ba330706eaa17f9ba9513fa502304.js",
    "bootstrap": "/assets/bootstrap.min-4ecafa8f279d0b285b3d27ca02c7e5da187907efe2c38f83eb8b4c7d6aa151c4.js",
    "lunr": "/assets/lunr-f99b014c8a6f84586ea3c195936e9cc362e046b318239f33786855679a6b8294.js",
    "@hotwired/turbo-rails": "/assets/turbo.min-38d030897e3554a265d3a3b6bdf4fb7509b08197ba2b6e3761683c07e776c1bc.js",
    "@hotwired/stimulus": "/assets/stimulus.min-dd364f16ec9504dfb72672295637a1c8838773b01c0b441bd41008124c407894.js",
    "@hotwired/stimulus-loading": "/assets/stimulus-loading-3576ce92b149ad5d6959438c6f291e2426c86df3b874c525b30faad51b0d96b3.js",
    "controllers/application": "/assets/controllers/application-368d98631bccbf2349e0d4f8269afb3fe9625118341966de054759d96ea86c7e.js",
    "controllers": "/assets/controllers/index-2db729dddcc5b979110e98de4b6720f83f91a123172e87281d5a58410fc43806.js",
    "controllers/search_controller": "/assets/controllers/search_controller-1c839dad802fbbcac7f45100753997dfa82c2453ff1b036badede2d38baef4ff.js",
    "controllers/theme_controller": "/assets/controllers/theme_controller-b01c6e0aeebf1ccac6a41c8358c52557f90e26684cb43214dcef7b5b11213069.js",
    "search": "/assets/search-ddd6c6d0d2f91d8051c02d2b76c8c07937235fba085eb3ff25464fb4db3d8569.js"
  }
}</script>
<link rel="modulepreload" href="/assets/popper-003a40d80fd205e1fa00da117d5bdc19720ba330706eaa17f9ba9513fa502304.js">
<link rel="modulepreload" href="/assets/bootstrap.min-4ecafa8f279d0b285b3d27ca02c7e5da187907efe2c38f83eb8b4c7d6aa151c4.js">
<link rel="modulepreload" href="/assets/turbo.min-38d030897e3554a265d3a3b6bdf4fb7509b08197ba2b6e3761683c07e776c1bc.js">
<link rel="modulepreload" href="/assets/stimulus.min-dd364f16ec9504dfb72672295637a1c8838773b01c0b441bd41008124c407894.js">
<link rel="modulepreload" href="/assets/stimulus-loading-3576ce92b149ad5d6959438c6f291e2426c86df3b874c525b30faad51b0d96b3.js">
<script type="module">import "application"</script>

  <script type="text/javascript">
    function setTheme() {
      let theme = localStorage.getItem('theme');
      if (!["light", "dark"].includes(theme)) {
        theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      }
      document.documentElement.setAttribute('data-bs-theme', theme);
    }

    setTheme();
    document.addEventListener('turbo:load', setTheme);
  </script>

  
</head>
<body data-controller="search">
  <nav class="navbar navbar-expand-lg navbar-light mb-2 flex-column">
  <div class="container">
    <a class="navbar-brand" href="/">Island94.org</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="/about">About</a></li>
        <li class="nav-item"><a class="nav-link" href="/archives">Archives</a></li>
        <li class="nav-item"><a class="nav-link" href="/tags">Tags</a></li>
        <li class="nav-item"><a class="nav-link" href="/feed.xml">RSS Feed <i class="bi bi-rss-fill"></i></a></li>

        <li class="nav-item py-2 py-lg-1 col-12 col-lg-auto">
          <div class="vr d-none d-lg-flex h-100 mx-lg-2 text-light-500"></div>
          <hr class="d-lg-none my-0 text-light-500">
        </li>

        <li class="nav-item dropdown" data-controller="theme">
          <button
            data-theme-target="switcher"
            class="btn btn-link nav-link dropdown-toggle"
            type="button"
            aria-expanded="false"
            data-bs-toggle="dropdown">
            <i data-theme-target="activeIcon" class="bi bi-circle-half"></i>
            <span data-theme-target="switcherText">Theme</span>
          </button>
          <ul class="dropdown-menu dropdown-menu-end">
            <li>
              <button
                type="button"
                class="dropdown-item"
                data-bs-theme-value="light"
                data-action="theme#switch"
                aria-pressed="false">
                <i class="bi bi-sun"></i> Light
              </button>
            </li>
            <li>
              <button
                type="button"
                class="dropdown-item"
                data-bs-theme-value="dark"
                data-action="theme#switch"
                aria-pressed="false">
                <i class="bi bi-moon-stars-fill"></i> Dark
              </button>
            </li>
            <li>
              <button
                type="button"
                class="dropdown-item"
                data-bs-theme-value="auto"
                data-action="theme#switch"
                aria-pressed="true">
                <i class="bi bi-circle-half"></i> Auto
              </button>
            </li>
          </ul>
        </li>

      </ul>

      <form id="search" class="d-flex" action="/search" method="get">
        <div class="input-group">
          <input data-search-target="input" data-action="input->search#syncInputs" id="search-box" class="form-control search" role="search" name="q" placeholder="Search" aria-label="Search" results="0" type="text" autocomplete="off">
          <button type="submit" class="btn btn-outline-secondary">
            <i class="bi bi-search"></i>
            <span class="visually-hidden">Search</span>
          </button>
        </div>
      </form>
    </div>
  </div>
  <div class="container">
    <div class="text-muted fst-italic">
      — Ben Sheldon's personal blog and <a href="/2012/04/a-commonplace-book">commonplace book</a>.
    </div>
  </div>
</nav>

  
  <div class="container container-body">
    

<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">
      <a class="post-link" href="/2025/07/consider-thruster-with-puma-on-heroku"><p>Consider Thruster with Puma on Heroku</p>
</a>
    </h1>
    <p class="post-meta text-muted">
        <time datetime="2025-07-25T18:18:00Z" itemprop="datePublished">July 25, 2025</time>

        • Tagged <a href="/posts/tags/rails">Rails</a>
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>To briefly catch you up to speed if you haven’t been minutely tracking Ruby on Rails performance errata: the Puma webserver has some mildly surprising behavior with the order in which it processes and prioritizes requests that are pipelined through keepalive connections; under load, it can lead to unexpected latency.</p>

<p>Heroku wrote <a href="https://www.heroku.com/blog/pumas-routers-keepalives-ohmy/">~3,000 words about this Puma thing</a>, and <a href="https://github.com/puma/puma/issues/3487">very smart people</a> are <a href="https://github.com/puma/puma/pull/3506">working on it</a>. All of this became mildly important because: Heroku upgraded their network router (“Router 2.0”), which <em>does</em> support connection keepalive, which has the potential to reduce a little bit of latency by reducing the number of TCP handshakes going over Heroku’s internal network between their router and your application dyno. People want it.</p>

<p>When you read the Heroku blog post (all several thousand words of it), it will suggest working around this with Puma configuration like (1) disabling connection keepalive in Puma or (2) disabling a Puma setting called <code>max_fast_inline</code>, though I’m pretty sure this has the same effect in Puma as disabling connection keepalives too (last I checked there wasn’t consensus in Puma as to what parts of the related behavior were intended but surprising, and what was unintended bugs in the logic).</p>

<p>Anyways, there’s a 3rd option: <strong>use Thruster</strong>.</p>

<ul>
  <li>Requests on the Heroku network between the Heroku router and Thruster running in your application dyno can use connection keepalives (sidenote: I’m 98% confident Thruster supports keepalives because <a href="https://github.com/basecamp/thruster/blob/10e33f6f5a2476231c00a59be209f7a58e98dc1a/internal/server.go#L9">Go <code>net/http</code></a> enables keepalives by default and Thruster doesn’t appear to explicitly disable them)</li>
  <li>Requests <em>locally</em> within your application dyno between Thruster and Puma can disable connection keepalive and there shouldn’t be any network latency for the TCP handshake because it’s all happening locally in the dyno.</li>
</ul>

<p>No one else seems to be blogging about this—a fact pointed out when I suggested this in the Rails Performance Slack. So here ya go.</p>

<ol>
  <li>Add the <code>thruster</code> <a href="https://github.com/basecamp/thruster">gem</a></li>
  <li>Update your Procfile: <code>web: HTTP_PORT=$PORT TARGET_PORT=3001 bundle exec thrust bin/rails server</code></li>
  <li>Disable Puma’s keepalives: <code>enable_keep_alives false</code></li>
</ol>

<p>I was already using Thruster with Puma on Heroku because of the benefits of x-sendfile support. If you’re worried about resource usage (because Thruster is yet another process) it’s been pretty minimal. I looked just now on one app and 13MB for Thruster next to 200MB for the Rails app running in Puma; seems tiny to me.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>heroku ps:exec <span class="nt">-a</span> APPNAME
<span class="c"># ....</span>
<span class="nv">$ </span>ps <span class="nt">-eo</span> rss,pss,cmd
  RSS   PSS CMD
    4     0 ps-run
11324 12792 /app/vendor/bundle/ruby/3.4.0/gems/thruster-0.1.14-x86_64-linux/exe/
 2960  1095 sshd: /usr/sbin/sshd <span class="nt">-f</span> /app/.ssh/sshd_config <span class="nt">-o</span> Port 1092 <span class="o">[</span>listener
 2220   407 /bin/bash <span class="nt">-l</span> <span class="nt">-c</span> <span class="nv">HTTP_PORT</span><span class="o">=</span><span class="nv">$PORT</span> <span class="nv">TARGET_PORT</span><span class="o">=</span>3001 bundle <span class="nb">exec </span>thrust
199336 187215 puma 6.6.0 <span class="o">(</span>tcp://0.0.0.0:3001<span class="o">)</span> <span class="o">[</span>app]
 8316  1821 ssh <span class="nt">-o</span> <span class="nv">ServerAliveInterval</span><span class="o">=</span>30 <span class="nt">-o</span> <span class="nv">ServerAliveCountMax</span><span class="o">=</span>3 <span class="nt">-o</span> HostKeyAlg
 9172  6346 skylightd
 8244  1367 sshd: u16321 <span class="o">[</span>priv]
 5548  1296 sshd: u16321@pts/0
 4444  1178 <span class="nt">-bash</span>
 4036  1964 ps <span class="nt">-eo</span> rss,pss,cmd
</code></pre></div></div>

  </div>
</article>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">
      <a class="post-link" href="/2025/07/customize-rails-i18n-key-suffixes-like-md-for-markdown"><p>How to customize Rails I18n key suffixes like <code>_md</code> for Markdown</p>
</a>
    </h1>
    <p class="post-meta text-muted">
        <time datetime="2025-07-16T10:00:00Z" itemprop="datePublished">July 16, 2025</time>

        • Tagged <a href="/posts/tags/rails">Rails</a> and <a href="/posts/tags/i18n">i18n</a>
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>If you’ve had reason to use internationalization in Rails on Rails, you’ve probably used a <a href="https://guides.rubyonrails.org/i18n.html#using-safe-html-translations">nifty feature</a> of it:</p>

<blockquote>
  <p>Keys with a <code>_html</code> suffix… are marked as HTML safe. When you use them in views the HTML will not be escaped.</p>
</blockquote>

<p>Authoring HTML within translations can be a pain because HTML is quite verbose and easy to mess up when maintaining multiple versions of the same phrase, or paragraph, or page across multiple languages.</p>

<p>It would be nice 💅 to have something like this:</p>

<blockquote>
  <p>Keys with a <code>_md</code> suffix can be authored in Markdown and will be automatically converted to HTML and marked as HTML safe.</p>
</blockquote>

<p>Markdown is a lot less verbose than HTML and easier to write and eyeball. Let’s do it!</p>

<p>First, we have to patch into the I18n <code>translate</code> method. It looks something like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/initializers/markdown.rb</span>

<span class="k">module</span> <span class="nn">Markdown</span>
  <span class="k">module</span> <span class="nn">I18nBackendExt</span>
    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="n">locale</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
      <span class="n">result</span> <span class="o">=</span> <span class="k">super</span>
      <span class="c1"># Rails missing key returns as MISSING_TRANSLATION =&gt; -(2**60) =&gt; -1152921504606846976</span>
      <span class="k">if</span> <span class="n">key</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">end_with?</span><span class="p">(</span><span class="s2">"_md"</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">result</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">String</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
          <span class="no">Markdown</span><span class="p">.</span><span class="nf">convert</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span>
          <span class="no">Markdown</span><span class="p">.</span><span class="nf">inline</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">end</span>
      <span class="k">else</span>
        <span class="n">result</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">ActiveSupport</span><span class="p">.</span><span class="nf">on_load</span><span class="p">(</span><span class="ss">:i18n</span><span class="p">)</span> <span class="k">do</span>
  <span class="no">I18n</span><span class="p">.</span><span class="nf">backend</span><span class="p">.</span><span class="nf">class</span><span class="p">.</span><span class="nf">prepend</span> <span class="no">Markdown</span><span class="o">::</span><span class="no">I18nBackendExt</span>
<span class="k">end</span>
</code></pre></div></div>

<p><strong>Fun Fact:</strong> Rails does a clever thing to detect missing translations. I18n accepts a stack of fallback defaults, and Rails <a href="https://github.com/rails/rails/pull/45572">appends a magic number</a> to the back of that stack: <code>-(2**60) =&gt; -1152921504606846976</code>. If a translation ever returns that value, Rails assumes that the translation fell through the entire fallback stack and is therefore missing. (It took me a bit of sleuthing to figure out what the heck this weird number meant while poking around.)</p>

<p>Second, we patch the Rails HTML Safe behavior to <em>also</em> make these strings HTML safe too:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/initializers/markdown.rb</span>

<span class="k">module</span> <span class="nn">Markdown</span>
  <span class="k">module</span> <span class="nn">HtmlSafeTranslationExt</span>
    <span class="k">def</span> <span class="nf">html_safe_translation_key?</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
      <span class="n">key</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">end_with?</span><span class="p">(</span><span class="s2">"_md"</span><span class="p">)</span> <span class="o">||</span> <span class="k">super</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">ActiveSupport</span><span class="o">::</span><span class="no">HtmlSafeTranslation</span><span class="p">.</span><span class="nf">prepend</span> <span class="no">Markdown</span><span class="o">::</span><span class="no">HtmlSafeTranslationExt</span>
</code></pre></div></div>

<p>That’s pretty much it!</p>

<p>If you’re uncomfortable patching things, Tim Masliuchenko has a gem called  <a href="https://github.com/timfjord/i18n-transformers"><code>I18n::Transformers</code></a> that makes it easy create custom key-based transformations. I believe you’ll still need to patch into the HTML safety behavior of Rails though—and anything involving marking things as HTML-safe should be always be scrutinized for <a href="https://guides.rubyonrails.org/security.html#cross-site-scripting-xss">XSS</a> potential.</p>

<p>Here’s the full initializer I have, including how I get Kramdown to create “inline” markdown:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># config/initializers/markdown.rb</span>

<span class="k">module</span> <span class="nn">Markdown</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">convert</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="k">raise</span> <span class="no">ArgumentError</span><span class="p">,</span> <span class="s2">"Can't provide both text and block"</span> <span class="k">if</span> <span class="n">text</span> <span class="o">&amp;&amp;</span> <span class="nb">block_given?</span>

    <span class="n">text</span> <span class="o">=</span> <span class="k">yield</span> <span class="k">if</span> <span class="nb">block_given?</span>
    <span class="k">return</span> <span class="s2">""</span> <span class="k">unless</span> <span class="n">text</span>

    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">strip_heredoc</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">options</span><span class="p">.</span><span class="nf">reverse_merge</span><span class="p">(</span>
      <span class="ss">auto_ids: </span><span class="kp">false</span><span class="p">,</span>
      <span class="ss">smart_quotes: </span><span class="p">[</span><span class="s2">"apos"</span><span class="p">,</span> <span class="s2">"apos"</span><span class="p">,</span> <span class="s2">"quot"</span><span class="p">,</span> <span class="s2">"quot"</span><span class="p">]</span> <span class="c1"># disable smart quotes</span>
    <span class="p">)</span>
    <span class="no">Kramdown</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">).</span><span class="nf">to_html</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">inline</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="kp">nil</span><span class="p">,</span> <span class="o">**</span><span class="p">)</span>
    <span class="c1"># Custom input parser defined in Kramdown::Parser::Inline</span>
    <span class="n">convert</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="ss">input: </span><span class="s2">"Inline"</span><span class="p">,</span> <span class="o">**</span><span class="p">).</span><span class="nf">strip</span>
  <span class="k">end</span>

  <span class="k">module</span> <span class="nn">HtmlSafeTranslationExt</span>
    <span class="k">def</span> <span class="nf">html_safe_translation_key?</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
      <span class="n">key</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">end_with?</span><span class="p">(</span><span class="s2">"_md"</span><span class="p">)</span> <span class="o">||</span> <span class="k">super</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="k">module</span> <span class="nn">I18nBackendExt</span>
    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="n">locale</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
      <span class="n">result</span> <span class="o">=</span> <span class="k">super</span>
      <span class="c1"># Rails missing key returns as MISSING_TRANSLATION =&gt; (2**60) =&gt; -1152921504606846976</span>
      <span class="k">if</span> <span class="n">key</span><span class="p">.</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">end_with?</span><span class="p">(</span><span class="s2">"_md"</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">result</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">String</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
          <span class="no">Markdown</span><span class="p">.</span><span class="nf">convert</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span>
          <span class="no">Markdown</span><span class="p">.</span><span class="nf">inline</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">end</span>
      <span class="k">else</span>
        <span class="n">result</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">ActiveSupport</span><span class="o">::</span><span class="no">HtmlSafeTranslation</span><span class="p">.</span><span class="nf">prepend</span> <span class="no">Markdown</span><span class="o">::</span><span class="no">HtmlSafeTranslationExt</span>
<span class="no">ActiveSupport</span><span class="p">.</span><span class="nf">on_load</span><span class="p">(</span><span class="ss">:i18n</span><span class="p">)</span> <span class="k">do</span>
  <span class="no">I18n</span><span class="p">.</span><span class="nf">backend</span><span class="p">.</span><span class="nf">class</span><span class="p">.</span><span class="nf">prepend</span> <span class="no">Markdown</span><span class="o">::</span><span class="no">I18nBackendExt</span>
<span class="k">end</span>

<span class="c1"># Generate HTML from Markdown without any block-level elements (p, etc.)</span>
<span class="c1"># http://stackoverflow.com/a/30468100/241735</span>
<span class="k">module</span> <span class="nn">Kramdown</span>
  <span class="k">module</span> <span class="nn">Parser</span>
    <span class="k">class</span> <span class="nc">Inline</span> <span class="o">&lt;</span> <span class="no">Kramdown</span><span class="o">::</span><span class="no">Parser</span><span class="o">::</span><span class="no">Kramdown</span>
      <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="k">super</span>
        <span class="vi">@block_parsers</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

  </div>
</article>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">
      <a class="post-link" href="/2025/07/is-everyone-ok-at-the-gemba"><p>Is everyone ok at the gemba</p>
</a>
    </h1>
    <p class="post-meta text-muted">
        <time datetime="2025-07-05T17:35:00Z" itemprop="datePublished">July 5, 2025</time>

        • Tagged <a href="/posts/tags/working">working</a>
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>The following is the bones of a half-written essay I’ve had kicking around in my drafts for the past 3 years, occassionally updated. I recently read <em>two</em> things that said it all better anyways, but if you read through you get my perspectives as someone in software cooking the goose.</p>

<p>One:  Albert Burneko’s <a href="https://defector.com/toward-a-theory-of-kevin-roose">“Toward a theory of Kevin Roose”</a>:</p>

<blockquote>
  <p>My suspicion, my awful awful newfound theory, is that there are people with a sincere and even kind of innocent belief that we are all just picking winners, in everything: that ideology, advocacy, analysis, criticism, affinity, even taste and style and association are essentially predictions. That what a person tries to do, the essential task of a person, is to identify who and what is going to come out on top, and align with it. The rest—what you say, what you do—is just enacting your pick and working in service to it.</p>

  <p>…. To these people this kind of thing is not cynicism, both because they believe it’s just what everybody is doing and because they do not regard it as ugly or underhanded or whatever. Making the right pick is simply being smart. And not necessarily in some kind of edgy-cool or subversive way, but smart the very same shit-eating way that the dorkus malorkus who gets onto a friendly first-name basis with the middle-school assistant principal is smart. They just want to be smart.</p>

  <p>So these people look at, say, socialists, and they see fools—not because of moral or ethical objections to socialism or whatever, or because of any authentically held objections or analysis at all, but simply because they can see that, at present, socialism is not winning. All the most powerful guys are against it. Can’t those fools see it? They have picked a loser. They should pick the winner instead.</p>
</blockquote>

<p>Two: Ed Zitrain’s <a href="https://www.wheresyoured.at/make-fun-of-them/">“Make fun of them”</a> (emphasis in the original):</p>

<blockquote>
  <p>In my opinion, there’s nothing more cynical than watching billions of people get shipped increasingly-shitty and expensive solutions and then <strong>get defensive of the people shipping them,</strong> and hostile to the people who are complaining that the products they use suck<strong>.</strong> </p>
</blockquote>

<h3 id="in-the-day-to-day">In the day to day</h3>

<p>One of the standard questions in my manager/executive interview kit is:</p>

<p><em>Walk me through what a good day looks like for you if this were your ideal job? And based on past experience, walk me through a bad day?</em> (yes, this is described in the Phoenix Project)</p>

<p>With some prodding, I want sus out how they think about a mix of group meetings, 1:1s, and heads down time. And ideally that the candidate can articulate some concrete artifacts of work (canned meetings, documents, etc.).</p>

<ul>
  <li>An excerpt of a good answer: Promoting someone up a level is really satisfying. Being in a calibration meeting where I’m presenting the packet my report and I developed together. I’ve designed promotion processes before and building an agenda for that meeting is a lot of fun. Do you have a career ladder here? I spend a lot of time doing gap analyses. I’ll spend at least a few hours every week running through my notes.</li>
  <li>An excerpt of a bad answer: Promoting someone up a level is really satisfying. It’s important people are recognized for their work.</li>
</ul>

<p>Good answers usually have jumping off points to talk about working and communication styles: “oh, is that something you’re doing over chat or email or in a shared document? Is that a repeating thing or as needed? How would you pull that together?” Bad answers usually stay at the general level (async, mastery, autonomy, meaning, etc.) and just… stop.</p>

<p>Having done maybe 30 of these interviews over the past decade, I’ve realized there are many people who seem otherwise competent but can’t talk, concretely, to what they do. Physically. Embodied. Even at a computer, what’s behind that digital window.</p>

<p>And I say “seems competent” cause, well, I usually pull these questions out at the end of the interview pipeline, and the candidates are otherwise qualified and their previous interviewers liked them enough to advance them to this stage. And even when the company has gone on to hire them, over my objections sometimes based on this question, they haven’t been <em>the worst</em>. The candidate I interviewed with the most memorably bad answers is now an SVP of Engineering at a major tech company. They’re doing ok.</p>

<p>But I do think there’s something there, that’s indicative of the moment. To break it down, there’s two awarenesses that I’m checking for:</p>

<ul>
  <li>Materiality: an awareness of where they <em>are</em> doing the work, and that’s also sorta doublechecking that they are aware that other people actually exist too. You read enough Ask a Manager and you realize <em>a lot</em> of powerful people struggle with object permanence when someone is outside their sight lines.</li>
  <li>Operationalization: a set of personal playbooks for making things happen. For example, I’m a big fan of skip 1:1s (when you meet with your report’s reports, or your manager’s manager) and will make point of intentionally setting those up. I have lots of opinions about what a minimally-viable-career-progression system looks like: career ladders and performance evaluation processes and calibration meeting agendas and 1:1 templates. Or more discipline specific, like inventories and gapping templates and decision docs,  In any job we don’t have to use <em>mine</em> but I sorta expect an experienced manager to have them in their back pocket and be interested in talking about them.</li>
</ul>

<p>All of which is to ask: <strong>take me to your gemba</strong>, ideally, and help me understand how it differs from your worst one too. <em><a href="https://en.wikipedia.org/wiki/Gemba">The Gemba</a></em> being the location where the work happens. Pedantically, it’s where the value is actually created, like the factory floor, but in this knowledge-heavy work… who can say? Our most valuable assets go home every night, right?</p>

<h3 id="the-ai-in-the-room">The AI in the Room</h3>

<p>All of this comes to mind with the contemporary exhortions of like “AI is mandatory” and “you must use AI in your job” sorts of manifestos and the reply-guys of like “you either git gud with AI or you fall behind and end up living in a cave and eating bats.”</p>

<p>So I take the previous thought of like “lots of managers and executives have no idea what their own work actually looks like”….</p>

<p>…and my thoughts about my own discipline: how does software get made? <a href="https://arxiv.org/pdf/1802.06321">Nobody knows.</a> On the individual level, it’s extremely rare to find people doing anything like Extreme Programming and its emphasis on pair programming and rigid collective team practices. In most of my decades of professional experience, software just expected to happen. <a href="https://arxiv.org/abs/2307.13143">Nobody knows.</a></p>

<p>For example, most teams I’ve worked with have huge differences in how individuals approach a problem: what and how much design or plannng they do up front, whether they start with tests or implementation, the order of components they work through, what they consider “done”. Drill down to the actual hands-on-keyboard-and-eyes-on-screen and editors and IDEs and development tooling are all over the place developer to developer. And no practices for sharing or learning from each other, and rarely interest either (“it works for me and I expect it would be painful to change”).</p>

<p>I have to imagine there’s a relation here, more often than not I’m talking to software managers and executives. Shared practices just aren’t <em>a thing</em>.</p>

<p>So I’ll simply say: it’s weird that AI is <em>the thing</em> to mandate, rather than like a consistent IDE, or testing strategy, or debugger workflow. That <em>this</em> is the thing, when there is so much everything-else that nobody knows.</p>

<h3 id="accountability-kayfabe">Accountability kayfabe</h3>

<p>I’ll admit it’s easy to take potshots at the weird things tech executive say and do, but I see a pattern here. Just prior to these AI mandates were the layoffs, which had their signature phrase and power pose: “I’m accountable for this decision.”</p>

<p>“Accountability” is a funny word as it means to “give an account.” Y’know, explain what happened, what was done, when, and by whom. What’s funny is that the word has been sort of walked back from actually giving that explaination, to the idea of the burden of having to give that explanation, to just a vibe of like “I’ve got it. This one’s on me.”</p>

<p>I noticed that a lot. I’m <a href="https://aworkinglibrary.com/writing/on-accountability">not the only one</a>.</p>

<p>I think the thing that people wanted to know, employees especially, was just like: materially and operationally, what the hell happened here?! And when there’s not an answer, there is a reasonable spectrum between active gaslighting on one side and my recognition that the people in charge could actually have no idea and maybe not even the personal capacity to know. It just ended up that way. Things happened.</p>

<h3 id="bringing-it-back-around">Bringing it back around</h3>

<p>I dunno. Just continue asking the “can you show me that?” “can we look at it together?” “how do you think that will effect things?” “is there anything you have in mind that I can do to help?” questions.</p>

  </div>
</article>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">
      <a class="post-link" href="/2025/06/recently-june-29-2025"><p>Recently, June 29, 2025</p>
</a>
    </h1>
    <p class="post-meta text-muted">
        <time datetime="2025-06-29T23:21:00Z" itemprop="datePublished">June 29, 2025</time>

    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <ul>
  <li>We have a new fridge; it is the same model as the old fridge because only that model would fit in the cabinetry. The installers also discovered that the water valve was broken and couldn’t be shut off; subsequently, the plumber determined that only the handle had snapped. I ordered a completely new water valve to unscrew its handle and attach that handle to the existing valve. In this economy.</li>
  <li>This week in Rails, I went back and replaced most of the places I was using turbo-broadcast-refresh and replaced them with targeted turbo-streams. I also spent a bunch of time trying to make an autogrowing textfield that didn’t bounce the page up and down which the <code>style.height = auto; style.height = scrollHeight</code>-strategy does with Bootstrap; this was <a href="https://gist.github.com/bensheldon/c68fbc7e7962bde5860ab4b5700585bb">the result</a>.</li>
  <li>I’m committed to RubyMine Junie over Cursor for AI-assisted coding. I think Cursor does ever-so-slightly better with generated code and the prompting UI, but RubyMine is so far beyond for everything else. I keep sharing this on Reddit, so here’s <a href="https://gist.github.com/bensheldon/b4fd84f9880b05ae57521beb1297e3a2">my agent guidelines</a> that I symlink into wherever the tool wants it.</li>
  <li>I’m still reading <em>The Future of Another Timeline</em>. And I started playing Satisfactory.</li>
</ul>

  </div>
</article>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">
      <a class="post-link" href="/2025/06/difference-rails-plugin-extensions-gems-railties-engines"><p>The difference between Rails Plugins, Extensions, Gems, Railties, and Engines</p>
</a>
    </h1>
    <p class="post-meta text-muted">
        <time datetime="2025-06-17T15:48:00Z" itemprop="datePublished">June 17, 2025</time>

        • Tagged <a href="/posts/tags/rails">Rails</a> and <a href="/posts/tags/rails-engines">Rails Engines</a>
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>There’s overlapping terminology that describes the act of packaging up some new behavior for Rails. I think of two gems I maintain that are of vastly different scales</p>

<ul>
  <li><a href="https://github.com/bensheldon/activerecord-has_some_of_many">￼<code>activerecord-has_some_of_many</code>￼</a> which adds two new tiny association methods to Active Record models in 150 lines of code.</li>
  <li><a href="https://github.com/bensheldon/good_job">GoodJob</a>, which is an entire Active Job backend with a mountable Web Dashboard and database models and custom job extensions in 10k lines of code.</li>
</ul>

<p>I was pondering the different terminology because I recently saw both ends of the spectrum discussed in the community:</p>

<ul>
  <li>A developer on Reddit announced a tiny new gem and a commenter wrote <em>well actually, in your Readme you called it an Engine but you shouldn’t do that.</em></li>
  <li>I got pinged on <a href="https://github.com/rails/rails/issues/52311">a Rails issue</a> that left me with the belief that some behavior, if <em>not</em> packaged as an Engine, could be expected to break.</li>
</ul>

<p>I think there are only two dimensions to consider when picking the correct terminology:</p>

<ul>
  <li>How the behavior is packaged</li>
  <li>Whether it’s necessary to package the behavior that way. Which isn’t even a criticism in my opinion, just an observation.</li>
</ul>

<p>Here’s my opinionated list, in order of somewhat increasing complexity:</p>

<ul>
  <li><strong>Rails Extension</strong>: A small monkeypatch or tiny new behavior to existing Rails behaviors (Active Record, Active Job, etc.). Especially if it’s not even a gem: simply a file you wrote a blog post about that gets copied into <code>config/extensions</code> and then <code>require_relative</code>’d in <code>config/application.rb</code>.</li>
  <li><strong>Rails Gem</strong> : Reductively, a gem is a load path for some code, and some ownership metadata, and maybe it’s been published to Rubygems.org. Nothing special.</li>
  <li>⭐️ <strong>Rails Plugin</strong>. A generic name covers all situations imo, regardless of size, scope, or complexity.</li>
  <li><strong>Railtie</strong>: When you write a gem that plugs into the Rails framework, you create <a href="https://api.rubyonrails.org/classes/Rails/Railtie.html">special file</a> named <code>lib/railtie.rb</code> that has a class that inherits from `<a href="https://api.rubyonrails.org/classes/Rails/Railtie.html">Rails::Railtie</a> that contains a DSL to configure how your gem’s behavior interfaces with Rails (configuration, initialization, etc.). I think Railtie is a bit of an odd-duck terminology-wise, but it makes sense considering…</li>
  <li><strong>Rails Engine</strong>: An “Engine” is <em>nearly</em> identical to a Railtie, but the file is named <code>lib/engine.rb</code> and it has a class that inherits from <code>Rails::Engine</code>. But <code>Rails::Engine</code> itself inherits from <code>Rails::Railtie</code>, so this is a matter of degrees. Your gem absolutely <em>needs</em> to use the Engine behavior if it wants to create mountable routes (though I guess you can mount a vanilla Rack app) or inherit from Rails Base classes like <code>ActiveRecord::Base</code>, <code>ActionController::Base</code>, <code>ActiveJob::Base</code>, etc. which live in the Engine’s own <code>app/</code> directory.</li>
</ul>

<p>(I’ll clock that the <a href="https://guides.rubyonrails.org/">The Rails Guides</a>, under the “Extending Rails” section, has separate guides for Plugins and Engines; the former somewhat surprisngly does not mention the latter.)</p>

<p>So if I go back to the two reasons why I wrote this, and try to be strict with this terminology:</p>

<ul>
  <li>If your Plugin <em>has</em> an <code>engine.rb</code> file, it <em>is</em> an Engine. Simple as that. If you don’t need the Engine-specific behavior, you could package it as a Railtie, but I think the difference is negligible.</li>
  <li>If you don’t have <em>any</em> dependencies on Rails (outside of maybe ActiveSupport) and don’t need to hook into the parent application’s configuration or initialization or framework, then you don’t need a Railtie or Engine at all. Just say it’s a gem that’s compatible with Rails and explain how to use it in that environment.</li>
  <li>Really, do what you want and tell people about it.</li>
</ul>

  </div>
</article>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">
      <a class="post-link" href="/2025/06/recently-june-8-2025"><p>Recently, June 8, 2025</p>
</a>
    </h1>
    <p class="post-meta text-muted">
        <time datetime="2025-06-09T00:58:00Z" itemprop="datePublished">June 9, 2025</time>

        • Tagged <a href="/posts/tags/recently">recently</a>
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Big business news for my startup: <a href="https://www.prnewswire.com/news-releases/frontdoor-benefits-receives-2-1-million-investment-to-improve-access-to-snap-and-public-assistance-programs-302472695.html">“Frontdoor Benefits Receives $2.1 Million Investment to Improve Access to SNAP and Public Assistance Programs”</a>. My cofounder Charlotte also <a href="https://frontdoorbenefits.substack.com/p/the-connecticut-project-invests-21m">added some details on our blog</a> too. Big milestone, and onto the next milestone and so forth.</p>

<hr />

<p>We went to a Golden State Valkyries basketball game last week. It was a lot of fun, and a <em>nice</em> seat was the cost of a substantially-less-nice seat to see the Golden State Warriors. We bought sweatshirts, so that means we’re going back.</p>

<p>On sports, since my last <em>Recently</em> we also went to two Giants games and a Warriors game (whomp whomp).</p>

<hr />

<p>Of random technical trivia, I discovered a cause of flaky tests: Turbo-Rails debounces broadcast refreshes and it’s possible for them to slip out of test transactions and cause chaos. I have <a href="https://github.com/hotwired/turbo-rails/issues/731">reported it</a>.</p>

<p>Also, my prior-colleague Issy wrote a nice thing <a href="https://ruby.social/@issyl0/114489859415578145">and mentioned me</a>.</p>

<hr />

<p>I finished reading Martha Well’s reissued <em>The Emilie Adventures</em>, which for all her books held my attention the least. I also read Brittany Newell’s <em>Soft Core</em> which was very good. I’m now reading <em>The Future of Another Timeline</em>.</p>

<p>For nonfiction, I (re-) read the updated edition of <em>The Strategy is Delivery</em>. And now I’m greatly enjoying Rouse’s <em>Game Design: Theory and Practice (2nd Edition)</em> which I found because it was referenced in the <a href="https://www.filfre.net/2025/05/the-end-of-sierra-as-we-knew-it-part-4-chainsaw-monday/">Digital Antiquarian’s history of the Sierra studio</a>.</p>

<hr />

<p>I beat the game <a href="https://en.wikipedia.org/wiki/Yoku%27s_Island_Express">Yoku’s Island Express</a>, which was a delightful experience on my desired theme of nice metroidvania (recommendations please). I also just started <a href="https://play.date/games/seasons/two/">Season 2 of Playdate</a>, which was a reason to find and charge it. On the theme of small handhelds, I ordered an <a href="https://www.adafruit.com/product/6323">Adafruit USB C Resistor Fixer</a> (say that 5 times fast) for the RGB30 that was collecting dust until I discovered some Pico 8 games I’d like to play.</p>


  </div>
</article>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">
      <a class="post-link" href="/2025/06/a-nice-email-for-subscribers"><p>A nice email for subscribers</p>
</a>
    </h1>
    <p class="post-meta text-muted">
        <time datetime="2025-06-04T20:13:00Z" itemprop="datePublished">June 4, 2025</time>

    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>I got this nice email from Defector, an online publication I pay for (along with <a href="https://deprogrammaticaipsum.com/issues">De Programmatica Ipsum</a>, <a href="https://www.garbageday.email/">Garbage Day</a>, and <a href="https://www.todayintabs.com/">Today in Tabs</a>. I think that’s it, though I guess I can include <a href="https://rubyland.news/">Rubyland.news</a> and <a href="https://newsletter.shortruby.com/">Short Ruby Newsletter</a> too). I yearn to share something like this for everyone who actively, if not always monetarily, supports my own work. The feeling is there, though not words this nice.</p>

<blockquote>

  <p>Subject: Thank you for supporting Defector</p>

  <p>I like when people ask me how Defector is doing. Thanks to subscribers like you, I get to say that not only that Defector is doing well, but that I love my work.</p>

  <p>I spent most of my life as a writer in jobs that were always and obviously impermanent. Roughly every 20 months, the people running things—people I never saw, and who had no interest in the work we did—would get bored, or nervous, or fall for some dippy executive fad, and <a href="https://defector.com/three-newsrooms-imploded-around-me-in-under-a-year">pivot some number of us out of our jobs</a>. Basically every innovation in media over the last few decades has been some version of this: an attempt by executive types to see how much less they can do, and how long they can get away with making everything <a href="https://defector.com/henry-blodget-invents-hires-sexually-harasses-blogs-about-nonexistent-ai-subordinate">smaller</a>, <a href="https://defector.com/the-familiarity-and-sadness-of-watching-the-washington-post-go-to-hell">sadder</a>, and <a href="https://defector.com/horny-sports-blogging-makes-a-bewildering-return-to-sports-illustrated">worse</a>.</p>

  <p>The most fundamental benefit of owning your workplace, as we do at Defector, is that we just don’t have to worry about that. Instead, we’re trying to solve the opposite problem: how to make the site <a href="https://defector.com/saquon-barkley-lured-me-to-an-arena-where-i-learned-passive-income-is-holy">better</a> and <a href="https://defector.com/what-did-she-see-at-the-end">broader</a> and <a href="https://defector.com/confessions-of-a-spelling-bee-pronouncer">more surprising</a> and <a href="https://defector.com/dave-mckenna-insists-they-have-ham-trucks-in-france">more fun</a>, tinkering towards the right balance of <a href="https://defector.com/for-sale-the-end-and-the-means-to-wait-for-it">smart</a> and <a href="https://defector.com/is-jon-heyman-paying-too-much-for-blueberries">stupid</a>. If you replace mystified Executive Maneuvers with the less abstract challenge of “writing good blogs for people who like to read,” this turns out to be both a good job and a viable business.</p>

  <p>But even after filtering out the noise from upstairs, there are plenty of other things to worry about. Chief among them is making sure that those good blogs reliably get in front of both existing subscribers like you and new ones we’d like to bring into the fold. All of those bad, previous jobs happened on an internet that worked better than our current one. Then as now, the people in charge were craven and nasty and dumb, but it was easier to find things, and there were notably more non-toxic places in which to talk about it all.</p>

  <p>So: thanks again for reading our blogs, and thanks especially for sharing them with people you think should know about Defector. (Here I’ll remind you that subscribers get an unlimited number of gift links each month to facilitate sharing.) Thanks also for making this the best job I’ve ever had. I’m very lucky to be able to keep doing this, with my friends and for such an engaged community of readers. None of it would exist without you.</p>

  <p>Be well,
David</p>

</blockquote>

  </div>
</article>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">
      <a class="post-link" href="/2025/05/recently-may-4-2025"><p>Recently, May 4, 2025</p>
</a>
    </h1>
    <p class="post-meta text-muted">
        <time datetime="2025-05-04T22:13:00Z" itemprop="datePublished">May 4, 2025</time>

        • Tagged <a href="/posts/tags/weeknotes">weeknotes</a> and <a href="/posts/tags/recently">recently</a>
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Frontdoor Benefits, my new startup, posted <a href="https://frontdoorbenefits.substack.com/p/frontdoor-benefits-a-first-newsletter">our first newsletter/update</a>. In doing our “planning” for it I took a lot from how I apprach this blog:</p>

<blockquote>
  <ul>
    <li>We are writing to a single individual (”Dear treasured friend” not “Hey friends”).</li>
    <li>We are writing from each of our personal voices (”This is Charlotte. I have… ” or “This is Ben. I have…”)</li>
    <li>Tone is casual and informal, we are sharing the things we’ve done or are thinking about with a close and curious person.</li>
    <li>We write about what we have done or thought about. Not so much what we intend to do in the future (definitely no commitments!)</li>
    <li>We try to avoid talking about the newsletter itself. For example, we don’t say how frequently we want to publish, or apologizing for it being a minute. Every post of the newsletter just <em>is</em>.</li>
  </ul>
</blockquote>

<p>It’s been successful so far, in that we asked for some things in it and people have delivered.</p>

<hr />

<p>I have been doing lots of research and having interesting conversations about customer/client/caseworker/constituent relationship management. Not so much “salesforce”  or “hubspot” but how to break down identities and artifacts and tasks; differentiating between task-based from case-based models, and worker activity from supervisory concerns. <em>If you have experience, or opinions, or related traumas, I’d love to chat: ben@openfrontdoor.com.</em></p>

<hr />

<p>I <a href="https://github.com/hotwired/turbo-rails/issues/731">discovered</a> that <code>turbo-rails</code> debounces Refresh Broadcasts; after being surprised for many, many minutes why a Rails runner script wasn’t broadcasting as expected. One of those things that simply manifests as strangely broken if you don’t go and read the code.</p>

<hr />

<p>My new workday is settling down into routine, and now I’m trying to add a regular morning swim 3 days a week. I managed one. Progress!</p>

<hr />

<p>I finished reading <em>Space Between Worlds</em> and its sequel <em>Those Beyond the Wall</em>. And started Kirstin Chen’s <em>Counterfeit</em> , which so far has me wondering whether phrases such as “nipple-length hair” is attributable to the character or the author (it was no mystery at all <a href="https://island94.org/2025/04/recently-april-7-2025">the last time</a> this came up).</p>

<p>Katamari Damacy is on Apple Arcade, and I’ve been playing that. I also picked up The Long Dark again which I haven’t played since early access before they added a story mode; as a walking simulator it’s a little slow and bleak and I’m not a big fan of graphically dying… but it is a walking simulator and I like that.</p>

<p>Last night we saw Empire of the Sun at the Greek theatre.</p>

<p>I renewed my CPR training and certification. That’s content.</p>

<hr />

<p>We’re fostering <a href="https://www.instagram.com/redcarpetcats/p/DJPuSbtTGYi/?img_index=1">Dennis, a sweet tabby cat who needs a forever home</a>.</p>

<hr />

<p>Fuck, <a href="https://www.reddit.com/r/AmeriCorps/comments/1k8oh2r/hello_all_starting_a_thread_to_express_fears_and/">AmeriCorps is gone</a>.</p>

  </div>
</article>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">
      <a class="post-link" href="/2025/04/recently-april-20-2025"><p>Recently, April 20, 2025</p>
</a>
    </h1>
    <p class="post-meta text-muted">
        <time datetime="2025-04-21T00:19:00Z" itemprop="datePublished">April 21, 2025</time>

        • Tagged <a href="/posts/tags/recently">recently</a>
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Angelina caught a cold, so the past week has been largely laying low and sleeping 9+ hours a night trying not to catch it myself. Not the worst life.</p>

<hr />

<p>Elevating this to top fish recipe: <a href="https://www.seaforager.com/recipes/rockfish-garlic-shallots-tomatoes-amp-and-a-lotta-herbs">Rockfish, Garlic, Shallots, Tomatoes &amp; and a lotta Herbs</a>.</p>

<hr />

<p>Using ChatGPT’s Web Search is ok. “Find me articles, marketing posts, and conference talks about [something]”. I have to follow up several times slightly differently (“anything else? What about lightning talks?”) and copy resulting links into a separate doc to organize to have something approaching comprehensive….  But pretty good and better than what I can get out of either Kagi or Google. I ignore the summaries and chatty nonsense and just copy the links and read them myself. Sorry climate and future generations.</p>

<hr />

<p>I cut ~30 seconds from my GitHub Actions build times by replacing my <code>apt-get install</code> step with an action that caches using <a href="https://github.com/awalsh128/cache-apt-pkgs-action">awalsh128/cache-apg-pkgs-action</a>; there’s a couple options but this one had the most stars in the marketplace:</p>

<pre><code># Before
- name: "Install packages"  
  run: |
  sudo apt-get -yqq update
  sudo apt-get -yqq install libvips-dev

# After
- name: "Install packages" 
  uses: awalsh128/cache-apt-pkgs-action@7ca5f46d061ad9aa95863cd9b214dd48edef361d
  with:
  packages: libvips-dev
  version: 1 # cache version, change to manually invalidate cache
</code></pre>

<hr />

<p>Turbo/hotwire stuff: I’ve been gradually replacing more granular broadcasts of like prepend/update/remove with page refresh events for their simplicity. The challenge I have is that if there is a form + refreshable content on the same page (sometimes with the form in the middle or multiple forms). If the content refreshes, I don’t want to refresh the form. But I do want the form to refresh itself when submitted (show validation messages, reset, etc.). I can wrap the form in a data-turbo-permanent for the first part, but then the form doesn’t update when it’s submitted.</p>

<p>My workaround to that is a stimulus controller that wraps the form and removes the <code>data-turbo-permanent</code> when the form is submitted, inspired by <a href="https://www.reddit.com/r/rails/comments/1d8fu0v/clever_new_hotwire_hack/">this</a>. Is there a better way to do it?</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">import</span> <span class="p">{</span> <span class="no">Controller</span> <span class="p">}</span> <span class="n">from</span> <span class="s2">"@hotwired/stimulus"</span>

<span class="sr">//</span> <span class="no">To</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span> <span class="n">wrap</span> <span class="n">a</span> <span class="n">form</span> <span class="n">to</span> <span class="n">allow</span> <span class="n">the</span> <span class="n">form</span> <span class="n">to</span> <span class="n">be</span> <span class="n">permanent</span> <span class="n">during</span>
<span class="sr">//</span> <span class="no">Turbo</span> <span class="no">Stream</span> <span class="n">refresh</span> <span class="n">events</span> <span class="n">but</span> <span class="n">to</span> <span class="n">update</span> <span class="n">normally</span> <span class="k">when</span> <span class="n">submitting</span> <span class="n">the</span> <span class="n">form</span><span class="p">.</span>
<span class="nf">/</span><span class="o">/</span> <span class="no">Example</span><span class="p">:</span>
<span class="sr">//</span>  <span class="o">&lt;</span><span class="n">div</span> <span class="n">data</span><span class="o">-</span><span class="n">turbo</span><span class="o">-</span><span class="n">permanent</span> <span class="nb">id</span><span class="o">=</span><span class="s2">"&lt;%= dom_id(@phone, :message_form) %&gt;"</span> <span class="n">data</span><span class="o">-</span><span class="n">controller</span><span class="o">=</span><span class="s2">"permanent-form"</span><span class="o">&gt;</span>
<span class="sr">//</span>    <span class="o">&lt;</span><span class="sx">%= form_with ...
//  &lt;/div&gt;

export default class extends Controller {
  connect() {
    this.submitHandler =</span> <span class="n">this</span><span class="p">.</span><span class="nf">submitForm</span><span class="p">.</span><span class="nf">bind</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
    <span class="n">this</span><span class="p">.</span><span class="nf">element</span><span class="p">.</span><span class="nf">addEventListener</span><span class="p">(</span><span class="s2">"submit"</span><span class="p">,</span> <span class="n">this</span><span class="p">.</span><span class="nf">submitHandler</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">disconnect</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">this</span><span class="p">.</span><span class="nf">element</span><span class="p">.</span><span class="nf">removeEventListener</span><span class="p">(</span><span class="s2">"submit"</span><span class="p">,</span> <span class="n">this</span><span class="p">.</span><span class="nf">submitHandler</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="n">submitForm</span><span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="nf">target</span><span class="p">.</span><span class="nf">matches</span><span class="p">(</span><span class="s2">"form"</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">this</span><span class="p">.</span><span class="nf">element</span><span class="p">.</span><span class="nf">removeAttribute</span><span class="p">(</span><span class="s2">"data-turbo-permanent"</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<p>I finished <em>Spinning Silver</em>. Now reading <em>The Space Between Worlds</em>.</p>

<p>I bought <a href="https://javascriptforrails.com/"><em>Javascript for Rails Developers</em></a>, largely because I like <a href="https://railsdesigner.com/articles/">the posts on Rails Designer</a>.</p>

<p>I started the demo for Unbeatable (“where music is illegal and you do crimes”); I like the art style, but <em>is it fun?</em> I dunno.</p>

<hr />

<p>I had to go to the shipping warehouse to pick up my new <a href="https://island94.org/2025/04/recently-april-7-2025">mechanical keyboard</a> because I kept missing the delivery person, but it otherwise arrived no problem.</p>

  </div>
</article>
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">
      <a class="post-link" href="/2025/04/recently-april-14-2025"><p>Recently, April 14, 2025</p>
</a>
    </h1>
    <p class="post-meta text-muted">
        <time datetime="2025-04-15T02:02:00Z" itemprop="datePublished">April 15, 2025</time>

        • Tagged <a href="/posts/tags/weeknotes">weeknotes</a> and <a href="/posts/tags/recently">recently</a>
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Last week I tried out a lot of coworking spaces: Canopy, Tandem, Temescal Works. We’re trying to find a space between Oakland and SF with nice outdoor walks.</p>

<hr />

<p>I’m having a great time being a technical cofounder to my (everything else!) cofounder.  It’s fun explaining what I am doing. And we have fun shouting “Monolith!” and “Skateboard [MVP]” all day long.</p>

<p>An example of an explanation I gave: one of our client advocate tools is a Twilio-powered Voice Conference Bridge where we can dial in any number of participants which helps shadow and assist our clients in their welfare application journey. We wanted to add DTMF tones for dialing extensions and navigating IVR systems. Unfortunately, the Twilio API that I used initially (<em>Create a Conference Bridge, then create a Participant Call</em>) doesn’t support DTMF tones so I had to flip the logic to a different API (<em>Create a Call, then add it to a Conference Bridge as a Participant)</em>. Figuring that out was a couple hours of reading docs and SDK code, feeling confident I wasn’t overlooking something, creating a runner script to bench test it, and finally putting the pieces into their production-ready places which was only like 20 lines of code at the end. That’s where the time goes.</p>

<hr />

<p>I had several conversations about <a href="https://x.com/tobi/article/1909251946235437514">“the AI memo”</a>. I’ll paste the two themes I talked about, in the words I put into the Rails Perf Slack:</p>

<blockquote>
  <p>I don’t know what Shopify’s culture is, but I imagine the pronouncement itself could be useful, for Tobi.</p>

  <p>As a leader, you say “everyone must… unless you get an exception from me” to learn by forcing exceptions to roll up to you directly. It’s a shitty way to learn, but power is shitty. (I mean “learn” in the very personal sense). It’s a tactic. The flip side is then as a leader you debug the need for the exceptions and that leads to a better policy.</p>

  <p>GitHub’s CEO said (not published) something similar (internally) 2 weeks before I left. I sweated it for a day, then DMed him and said “as a manager, I’m not aware of any LLM api that is approved for my use for internal admin stuff?” and he pointed me to the GitHub Models product that is totally unreferenced on any of the internal docs about staff AI tools. I poked that enablement team to add it, and I dunno if the CEO actually followed up with anyone to debug the low awareness (the story of my DM got retold at a different meeting as one about security, but it was really my complete unawareness and its absence on any of the tool lists that were intended to be the starting place for staff to integrate AI into their work).</p>

  <p>TLDR: in a culture of opennness (safety to DM the CEO about the policy) and learning (the policy is the start not the end of discussion). I could see the pronouncement to be catalytic.</p>
</blockquote>

<p>And</p>

<blockquote>
  <p>I appreciate that FOMO hype (“don’t be left behind”) has been largely absent [in this Slack community], though I find it elsewhere and a huge distraction.</p>

  <p>I think a lot in this thread could have the word “AI” replaced with “Rubymine” and it would be an equally familiar discussion between folks who use it, folks who are curious, and folks who are happy with their current code editor and wish others would stop pushing Rubymine cause it’s slow and costs money and makes developers lazy, analogously.</p>

  <p>I share that because I don’t think it’s a new experience to be like: “both of us are producing software but our moment-to-moment experience is wildly materially different” (eg “here is my elaborate process for naming and organizing methods so I can find them later” vs “I cmd-click on it and I go there”). … and then people debate whether that difference matters or not in the end.</p>

  <p>When I think of my own experience in The Editor Wars I think the only meaningful thing is to go pair with somebody and observe their material experience producing software in situ, fumbles and all.</p>
</blockquote>

<p>I did my first Deep Research this week; it was good <a href="https://www.snopes.com/fact-check/ai-education-linda-mcmahon/">A1</a>.</p>

<hr />

<p>Week one of my startup journey and I already made <a href="https://github.com/rails/rails/pull/54895">a successful Rails PR</a> with a bug fix. I didn’t think it was a big deal but it got backported too 💪</p>

<hr />

<p>On Saturday I did what I’m trying to make my standard 10-mile hike: Stinson Beach to Muir Woods loop (Steep Ravine up, Bootjack down, Ben Johnson up, Dipsea back down). Shandy and fries at the end.</p>

<p>Sunday was a swim (the Bay was a balmy 57F/14C !) and the treat of a Warriors day game with Angelina’s geospatial colleagues, and dinner and ice cream and showing them all our favorite park walks.</p>

<hr />

<p>I’m still reading <em>Spinning Silver</em>; it’s good <em>and</em> long! I have not played Witcher 3 since writing about it last time, or really anything.</p>

  </div>
</article>


<hr>

<div class="d-flex justify-content-between mb-5">
    <a href="/posts/2" class="btn btn-outline-primary">Older posts</a>
</div>

  </div>

</body>
</html>
